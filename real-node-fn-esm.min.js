export default{RealWorld,RealNode,RealGroup,RealTarget,RealStory,RealPromise,RealElement,RealCanvas,RealLoader,RealSelect,RealComtag,RealSVG,RealDivList,RealImgList,RealDivQueue,createRealDivSelect,createRealDivSearch,createRealDivSeries}=(()=>{function prevent(e){return e}let l=globalThis.Element??prevent,s=globalThis.performance??Date,n=[],M=s.now(),p=Object.create(null),o=l!==prevent,a={enumerable:!1},c={value:null,writable:!0},h={writable:!1,enumerable:!1},f=(...e)=>console.log(...e),u=function*tryYieldKey(e,t,r){try{for(var i of e)yield i?.[t]??i}catch(e){console.error(e)}};var e,r,d=!1,m=globalThis.setInterval??prevent,i=globalThis.clearInterval??prevent;try{r=require,e=module.exports,d=!0}catch{e={},r=r=>new Promise(async t=>{try{var e=await import(String(r));t("default"in e?e.default:e)}catch(e){t(e),console.log("\n\r\t"+String(e)+e?.stack)}})}let v=r("fs");RealWorld.onload=o?new Promise(e=>addEventListener("load",function tempListener(){e(),removeEventListener("load",tempListener)})):d?Promise.resolve():new Promise(async t=>{if(m===prevent){let{setTimeout:s,clearTimeout:e}=globalThis.setTimeout?globalThis:await r("os");function Interval(e,t,...r){return null==this||this===globalThis?new Interval(e,t,...r):(this._=s(this.transform(e,t,...r),t,...r),this)}Interval.prototype.transform=function(e,t,...r){let i=()=>{this._=s(i,t,...r),e.apply(null,r)};return i},Interval.prototype.clear=function(){e(this._)},m=Interval,i=e=>e.clear(),Reflect.defineProperty(w.eventLoop,"_id",{value:m(()=>w.eventLoop._mainFn(),w.eventLoop.timeSep)}),t()}}),RealWorld.createInterval=function(e,t){return(e=new RealWorld(e)).intervalFn=t,e},RealWorld.getPromiseState=(()=>{let t=Symbol(),r=e=>+(t!==e),i=()=>-1;return function getPromiseState(e){return Promise.race([e,t]).then(r,i)}})(),RealWorld.onceIf=async(t,e)=>{if("function"!=typeof t)throw new TypeError('"ifFn" must be Function !');let r=new RealWorld(e);await new Promise(e=>(r.ifFn=t,r.soFn=e)),i(r._id)},RealWorld.cb2promise=function({thisArg:i,useFn:s,callback:t=function thisResolve(...e){this.resolve(e)}}=p,...o){if("function"!=typeof(s="function"!=typeof s?i?.[s]:s))throw new Error('=> Wrong:\n\t"thisArg" is not Object\n or\n\t"useFn" not in "thisArg" !');return new Promise(e=>{let r={callback:t,resolve:e};try{s.call(i,...o,(...e)=>r.callback(...e))}catch(t){try{s.call(i,(...e)=>r.callback(...e),...o)}catch(e){r.resolve([new Error("=> Neither head or tail of parameters is Callback !\n"+String(t?.stack??t)+"\n"+String(e?.stack??e))])}}}).catch(e=>console.error(e.stack))},RealWorld.prototype.destroy=function(){i(this._id),this._mainFn()},RealWorld.prototype.then=function(e){return"function"==typeof e&&this.fnList.unshift(e),this},RealWorld.prototype.getRealElement=function(){return new N({self:this.self,key:"innerHTML"},{id:this.self.id,initValue:this.self.innerHTML})},RealWorld.prototype.setTimeSep=function(e){return(Number.isFinite(e=Number(e))?e:10)!==this.timeSep&&(i(this._id),Reflect.defineProperty(this,"timeSep",{value:e}),Reflect.defineProperty(this,"_id",{value:m(()=>this._mainFn(),this.timeSep)}))},RealWorld.prototype._mainFn=function(){if(!this.paused){try{this.intervalFn?.()}catch(e){this.intervalFn=null,console.error(e)}try{this.info=this.fnList.pop()?.call?.(this,this.info)}catch(e){console.error(e)}try{this.ifFn?.()&&(this.ifFn=this.soFn=void this.soFn?.())}catch(t){try{this.ifFn?.()}catch(e){t=e,this.ifFn=null,this.paused=!0}this.paused||(this.soFn=null),this.paused=!1,console.error(t)}}};var g,y=RealWorld;function RealWorld(e,...t){if(null==this||this===globalThis)return new RealWorld(e,...t);try{Number.isFinite(this.timeSep=Number(e))||(this.timeSep=10)}catch{this.timeSep=10}return this._id=m(()=>this._mainFn(),this.timeSep),this.fnList=t,this.info=g,this.self=o?document.createElement("div"):{},this.paused=!1,this.intervalFn=g,this.ifFn=g,this.soFn=g,Reflect.defineProperty(this,"_id",h),Reflect.defineProperty(this,"fnList",h),Reflect.defineProperty(this,"timeSep",h),this}var R,t,w=class RealNode{static error(e){throw new Error(this.name+" : "+e)}static _sys=new Map;static t0=Date.now();static tryRealNode=!1;static now=Promise.resolve();static eventLoop=new y;static proto=class AntiNode{tryRealNode;childRNs=[];["get"];["set"];react;id;value};static search(e){return RealNode._sys.get(e)}static newByInitValue(e){return new RealNode({initValue:e})}static is(e,t){return Object.is(e,t)||e===t}static justNow(e,t,...r){return RealNode.now.then(()=>e.apply(t,r))}static arrayToObject(...e){for(var t=Object.create(null),r=n.concat(...e),i=r.length,s=0;s<i;s++)t[String(r[s])]=r[s];return t}static createExpression=(R=()=>!1,(e,...t)=>new RealNode({get:e,set:R},!0,...t));static createHidden(e){return new RealNode(((e=Object.assign({},e)).display=!1,e))}static check(e){for(var t of RealNode._sys.entries())if(e===t[1])return e.id===t[0]}static afterNow(t,e,r,...i){var s=new Promise(e=>RealNode.eventLoop.then(()=>e(t.apply(r,i))));return e||(RealNode.now=s.catch(prevent)),s}static protoCreate(e,...t){e=new RealNode({get:e});return e.proto.value=t,e}static createNumber=RealNode.protoCreate.bind(null,function(e=0){if(!Array.isArray(this.proto.value))return+(this.proto.value instanceof RealNode?this.proto.value:this.proto).value;for(var t of this.proto.value)e+=+(t instanceof RealNode?t.value:t);return e});static copyObj=function copyObj(e){if(Object(e)!==e)return new.target?Object(e):e;var t,r=Array.isArray(e)?[]:Object.create(null);for(t of Object.keys(e))95!==t.charCodeAt(0)&&(r[t]=copyObj(e[t]));return r};static createString=RealNode.protoCreate.bind(null,function(){if(Array.isArray(this.proto.value)){for(var e=this.proto.value.concat(),t=e.length;0<t--;)e[t]instanceof RealNode&&(e[t]=e[t].value);return e.join("")}return String((this.proto.value instanceof RealNode?this.proto.value:this.proto).value)});static async time(e,t){var r=s.now(),i={time:null,error:null,value:null};try{i.value=await("function"==typeof e?e():e)}catch(e){console.error(i.error=e)}if(i.time=s.now()-r,"function"==typeof t)try{t(i.time,i.error,i.value)}catch(e){console.error(e)}return i}static makeNumStr0oTail(e,t){var r,i;switch(typeof e){case"bigint":return e.toString();case"symbol":case"undefined":return"NaN"}try{e=+e}catch{return"NaN"}return Number.isFinite(e)?(t="number"!=typeof t?9:18<t?18:t<0?0:Math.floor(t),{0:r,1:i=""}=e.toString(8).split("."),BigInt("0o"+r).toString()+"_+0o"+i.slice(0,t).padEnd(t,"0")):"NaN"}static _react(e,t=!0,r=!0,i=!0){try{for(var s,o=this._getPositionsOfChildRN(e);o.length;){var a=o.pop().reverse();if(!a.length)return this.realSet(e.value,t,r,i);for(s=this.proto.value;1<a.length;)s=s[a.pop()];e.value!==s[a[0]]&&(s[a[0]]=e.value)}return t&&this.react?.(i),r&&this.notify(i),!0}catch(e){if(this instanceof RealNode)throw e;this.error('Please avoid using method "react" of typeof '+this?.name+" !\n"+e.message)}}protoReact(){}protoGet(){return this.proto.value}log(...e){console.log(this+":",...e)}error(e){throw new Error(this+'\n"""\n'+String(e)+'\n"""')}protoSet(e){return e!==this.proto.value&&(this.proto.value=e,!0)}clearChildRNs(){for(;this.proto.childRNs.length;)this.proto.childRNs.pop().display=!1;return this}realReact(e=!0,t){var r=this.proto.react;return!!r&&(r.call(this),e&&this.notify(t),!0)}[Symbol.toPrimitive](e){try{return"number"===e?Number(this.value):"[object "+this.constructor.name+"]{ "+this.id.description+" }"}catch{return NaN}}notify(t,e){let r="function"==typeof e?e:prevent,i={depth:0,done:!1,finished:RealNode.justNow(async()=>{for await(var e of this.protoNotify(t,i))try{r(e,i)}catch{}})};return i}async*protoNotify(e,t){"number"!=typeof t?.depth&&(t={depth:0,done:!1});var r,i=this.relativeRNs.concat();do{await 0;var s=[],o=[];for(r of i)try{if(!(r=RealNode.search(r))||e&&this===r)continue;r.react?.(),s.push(r)}catch(e){o.push(e)}yield*o,t.depth++,i=n.concat(...u(s,"relativeRNs",n))}while(i.length);t.done=!0}realSet(e,t,r,i){try{var s;return(this.proto.set.call(this,this.proto.tryRealNode&&(s=this._computePositionsOfRNs(e)).length?this._dealWithPositionsOfRNs(s,e):e)??!0)&&(t&&this.react?.(),r&&this.notify(i),!0)}catch(e){return console.error(e),e}}_getPositionsOfChildRN(e){for(var t,r=this.proto.childRNs,i=[],s=r.length;0<s--;)e===(t=r[s].info.values()).next().value&&i.push(...t);return i}relate(...e){for(var t=e[e.length-1],r=RealNode.search(t?.id??t);e.length;)"symbol"!=typeof(t=e.pop())&&(t instanceof RealNode?t=t.id:this.error('=> "relativeRNs['+e.length+']" is not legal id !')),RealNode.search(t)&&!this.relativeRNs.includes(t)&&this.relativeRNs.push(t);return r}unrelate(...e){if(!e.length)return!1;var t=this.relativeRNs.concat(),r=e.length;for(this.relativeRNs.splice(0);0<r--;)"symbol"!=typeof e[r]&&(e[r]=e[r]?.id);for(r=t.length;0<r--;)e.includes(t[r])||this.relativeRNs.push(t[r]);return t.length!==this.relativeRNs.length}_computePositionsOfRNs(e,t=2,r=[],i=0){var s,o,a=[];if(e instanceof RealNode)a.push((r.unshift(e),r));else if(i<t&&Object(e)===e)for(s=(o=Reflect.ownKeys(e)).length;0<s--;)a=a.concat(this._computePositionsOfRNs(e[o[s]],t,[...r,o[s]],i+1));return a}_dealWithPositionsOfRNs(i,s){var o,a,n,l=this.clearChildRNs().proto.childRNs,c=[];let h=this.constructor._react;for(i=i.concat();i.length;){let e=i.pop(),t=e[0],r=e.slice(1);if(r.length){for(o=s,a=0,n=r.length-1;a<n;a++)o=o[key];o[r[a]]=t.value}else s=t.value;(a=c.indexOf(t))<0?(c.push(t),l.push(t.relate(new RealNode({info:[t,r],react:(...e)=>h.call(this,t,...e)})))):l[a].info.push(r)}return s}get id(){return this.proto.id}get childRNs(){return this.proto.childRNs}get value(){return this.get()}set value(e){this.realSet(e,!0,!0)}get set(){return this.realSet}set set(e){this.proto.set="function"==typeof e?e:this.protoSet}get get(){return this.proto.get}set get(e){this.proto.get="function"==typeof e?e:this.protoGet}get react(){return this.proto.react}set react(e){this.proto.react="function"==typeof e?e:e?this.protoReact:null}get display(){return RealNode._sys.has(this.id)}set display(e){e?RealNode._sys.set(this.id,this):RealNode._sys.delete(this.id)}get tryRealNode(){return this.proto.tryRealNode}set tryRealNode(e){e=this.proto.tryRealNode=Boolean(e);for(var t=this.proto.childRNs.length;0<t--;)this.proto.childRNs[t].display=e}constructor(e,t=RealNode.tryRealNode,...r){e=Object(e),this.relativeRNs=[],this.proto=null,this.info=null;let i=(...e)=>{return[e,...t]=[i,...e],t.length?e.realSet(...t,!0,!0,!0):e.get();var t};return Reflect.setPrototypeOf(i,Reflect.getPrototypeOf(this)),Reflect.defineProperty(i,"length",c),Reflect.defineProperty(i,"name",c),i.relativeRNs=this.relativeRNs,i.proto=new this.constructor.proto,i.info=e.info,i.proto.id=Symbol(String(e.id??e.info?.id??"")),Reflect.defineProperty(i,"relativeRNs",a),Reflect.defineProperty(i,"proto",h),i.display=e.display??!0,i.get=e.get,i.set=e.set,i.react=e.react,i.relate(...r),i.proto.value=e.initValue,i.tryRealNode=t,"value"in e&&(i.value=e.value),i}},b=class RealGroup extends w{static tempProxy=class AntiGroup extends Function{apply(){return this.self}ownKeys(){return Reflect.ownKeys(this)}has(e,t){return Reflect.has(this,t)}construct(){return this.realGroup.getByFilter()}isExtensible(){return Reflect.isExtensible(this)}["get"](e,t){return this.realGroup.get(t)}preventExtensions(){return Reflect.preventExtensions(this)}deleteProperty(e,t){return Reflect.deleteProperty(this.self,t)}setPrototypeOf(e,t){return Reflect.setPrototypeOf(this,t)}["set"](e,t,r){return this.realGroup.set(Object.create(null,{[t]:{value:r}}))}defineProperty(e,t,r){return Reflect.defineProperty(this.self,t,r)}constructor(e,t){super(""),this.self=e,this.realGroup=t}};static groupMap=new Map;static _=()=>!0;static newByObj(e){return new RealGroup({self:Object(e)})}static createDeepGroup=function createDeepGroup(e,t="",r,i){if(Object(e)!==e)return i?r?w.createHidden({id:t,initValue:e}):e:new RealGroup;var s=Reflect.getPrototypeOf(e);if(s&&s!==Object.prototype)return i?r?w.createHidden({id:t,initValue:e}):e:new RealGroup({self:e});for(var o=Object.create(null),a=Reflect.ownKeys(e),n=a.length,l=0;l<n;l++)o[a[l]]=createDeepGroup(e[a[l]],a[l],r,!0);return new RealGroup({self:o})};static getObjByStructure=(()=>{let a=(e,t)=>{var r,i,s,o;switch(t){case"boolean":return Boolean(e);case"null":case"undefined":return null;case"bigint":try{return BigInt(e)}catch{return 0n}case"number":try{return Number(e)}catch{return NaN}case"string":try{return String(e)}catch{return"Symbol(unknown)"}case"array":switch(typeof e){default:return[];case"string":return e.split("");case"object":if(null===e)return[];if(Array.isArray(e))return e.concat();for(s=[],i=Object.keys(e),r=0;;){1;{if(!(Number.isInteger(o=+i[r++])&&-1<o))return s;try{s[o]=e[o]}catch(e){console.error(e)}}}}default:if(Object(t)!==t)return e}for(e=Object(e),s=Object.create(null),r=(i=Object.keys(t)).length;0<r--;)try{t[o=i[r]];try{s[o]=a(e[o],t[o])}catch(e){s[o]=a(null,t[o]),console.error(e)}}catch(e){s[o]=null,console.error(e)}return s};return a})();keys(e){return e?Reflect.ownKeys(this.proxy()):Object.keys(this.proxy())}realSet(e,t,r){try{return this.protoSet(e)&&(t&&this.notify(r),!0)}catch(e){return console.error(e),e}}addSetterListener(e,t){var r;t&&("function"!=typeof t&&this.error('"listener" must be function !'),null==e&&(e=RealGroup._),Array.isArray(r=this.listenerMap.get(e))||this.listenerMap.set(e,r=[]),r.push(t))}protoReact(s=n){Array.isArray(s)||this.error('"keyArray" must be Array !'),this.listenerMap.forEach((t,r)=>{try{if("function"==typeof r?r(s):-1!==s.indexOf(r))for(var e=t.length,i=0;i<e;i++)try{t[i]()}catch(e){this.log("Wrong with ",t[i])}}catch(e){this.log("Wrong with ",r)}})}tryRealNodeSetter(){for(var e=this.proxy(),t=Reflect.ownKeys(e),r=t.length;0<r--;)Reflect.has(Reflect.getOwnPropertyDescriptor(e,t[r]),"get")||e[t[r]]instanceof w||(e[t[r]]=w.createHidden({initValue:e[t[r]]}));return this}getByFilter(e){for(var t=this.proxy(),r=Reflect.ownKeys(t),i="function"!=typeof e,s=Object.create(null),o=r.length;0<o--;)(i||e(r[o]))&&Reflect.set(s,r[o],t[r[o]]instanceof w?t[r[o]].value:t[r[o]]);return s}protoSet(e){if(Object(e)!==e)return!1;var t,r=this.proxy(),i=[];for(t of Reflect.ownKeys(Object(e)))e[t]instanceof w?(r[t]=e[t],i.push(t)):r[t]instanceof w?r[t].set(e[t],!0,!0,!0)&&i.push(t):e[t]!==r[t]&&(r[t]=e[t],i.push(t));if(!i.length){for(var s=this.listenerMap.get(RealGroup._),o=s.length,a=0;a<o;a++)try{s[a]()}catch(e){this.log("Wrong with ",s[a])}return!1}try{this.protoReact(i)}catch(e){this.log(e?.stack??e)}finally{return!0}}protoGet(...e){if(0===e.length)return this.getByFilter();var t=e[0];if(Object(t)!==t)return(t=this.proxy()[t])instanceof w?t.value:t;for(var r=this.proxy(),i=Reflect.ownKeys(t),t=Object.create(null),s=i.length;0<s--;)Reflect.set(t,i[s],r[i[s]]instanceof w?r[i[s]].value:r[i[s]]);return t}get proxy(){return this.proto.value}get set(){return this.realSet}set set(e){}get get(){return this.protoGet}set get(e){}get react(){return this.protoReact}set react(e){}get tryRealNode(){return!1}set tryRealNode(e){e&&this.log("I can not try realNode !")}listenerMap=new Map([[RealGroup._,[]]]);constructor({id:e,info:t,self:r=Object.create(null)}=p){var i;if((i=RealGroup.groupMap.get(r))instanceof RealGroup)return console.log('Please do not new for "self":'+r+" again !"),i;super({id:e,info:t}),Object(r)!==r&&this.error('"self" not typeof object !'),Reflect.defineProperty(this,"listenerMap",h),i=new RealGroup.tempProxy(r,this),this.proto.value=new Proxy(i,i),RealGroup.groupMap.set(r,this)}},S=class RealTarget extends w{static proto=class AntiTarget extends w.proto{self;isElement;transform};static newBySelf(e){return new this({self:e})}static searchByObj(e){var t=[];if(Object(e)===e)for(var r of RealTarget._sys.values())e===r.self&&t.push(r);return t}static _react(e,t=!0,r=!0,i=!0){try{for(var s,o=this._getPositionsOfChildRN(e);o.length;){var a=o.pop().reverse();if(!a.length)return this.realSet(e.value,t,r,i);for(s=this.proto.value;1<a.length;)s=s[a.pop()];e.value!==s[a[0]]&&(s[a[0]]=e.value)}return this.fix(),t&&this.react?.(i),r&&this.notify(i),!0}catch(e){if(this instanceof RealTarget)throw e;this.error('Please avoid using method "react" of typeof '+this?.name+" !\n"+e.message)}}protoTransform(e){return e}fix(){return this.self[this.key]=this.transform(this.proto.value),this}clearClassName(){return this.proto.isElement&&!(this.proto.self.className="")}addClassName(...e){return this.proto.isElement&&(this.proto.self.classList.add(...e),!0)}toggleClassName(e){return this.proto.isElement&&this.proto.self.classList.toggle(e)}removeClassName(...e){return this.proto.isElement&&(this.proto.self.classList.remove(...e),!0)}getIndexWithin(){for(var e=0,t=this.proto.self;t=t.previousElementSibling;)e++;return e}realSet(e,t,r,i){try{var s;return(this.proto.set.call(this,this.tryRealNode&&(s=this._computePositionsOfRNs(e)).length?this._dealWithPositionsOfRNs(s,e):e)??!0)&&(this.fix(),t&&this.react?.(),r&&this.notify(i),!0)}catch(e){return console.error(e),e}}applyCSS(e,t){this.proto.self instanceof l||this.error("I am not RealElement !");var r=e;if("string"!=typeof e){for(;(r=r?.parentElement)&&r!==this.proto.self;);r?e=" #"+(e.id||(e.id=N.getRandomId())):this.error('"selfSelector" must be String or my descendant !')}var i=this.proto.self.id||(this.proto.self.id=N.getRandomId());return!!(t="string"==typeof t?N.myStyle.get(t):Object(t))&&(N.addCSSRules("#"+i+(/^[A-Za-z]/.test(e)?" ":"")+e,t),N.addId(i,!1),!0)}clone(e,t,r){var i={self:this.proto.self instanceof l?this.proto.self.cloneNode():Object.assign(Object.create(Reflect.getPrototypeOf(this.proto.self)),this.proto.self),key:this.key,transform:this.transform},i=new RealTarget(i,{get:this.proto.get,set:this.proto.set,react:this.proto.react,id:this.id.description+"-clone",info:this.info,initValue:e?this.proto.value:void 0});return Reflect.setPrototypeOf(i,Reflect.getPrototypeOf(this)),null==r&&(i.relativeRNs=r?this.relativeRNs:this.relativeRNs.concat()),t?i.fix():i}get isElement(){return this.proto.isElement}get transform(){return this.proto.transform}set transform(e){this.proto.transform="function"==typeof e?e:this.protoTransform}get self(){return this.proto.self}set self(e){Object(e)===e?this.proto.isElement=(this.proto.self=e)instanceof l:this.error('=> "self" must be Object !')}constructor({self:e,key:t,transform:r},i,s,...o){super(i,s),this.proto,this.self=e,this.key=t,this.transform=r,s&&this.realSet(i.initValue),this.relate(...o),this.addClassName(this.constructor.name)}},N=class RealElement extends S{get self(){return this.proto.self}set self(e){Object(e)===e?this.proto.isElement=(this.proto.self=e)instanceof l:this.error('=> "self" must be Element !')}static idSet=new Set;static findId(e){return this.idSet.has(e)}static deleteId(e){return"string"!=typeof e&&console.error('=> Please use String "id" !'),this.idSet.delete(e)}static getRandomId(){for(var e;this.idSet.has(e="C3"+Math.floor(1e14*Math.random()).toString(36)););return e}static addId(e,t=!0){e&&("string"!=typeof e?this.error('=> Please use String "id" !'):this.idSet.has(e)?t&&this.error('=> Please use another "id" !'):this.idSet.add(e))}static myStyle=new Map;static selectorEventListeners={};static keyboardController=(o&&addEventListener("keydown",e=>{if(!/^(TEXTAREA)|(SELECT)|(INPUT)$/.test(document.activeElement?.tagName)){var t,r,i=document.querySelector(".onkeyboardControl")??document.querySelector(".keyboardController");if(i){switch(e.key){case RealElement.keyboardController?.previous:t=-1;break;case RealElement.keyboardController?.next:t=1;break;case RealElement.keyboardController?.enter:(r=S.searchByObj(i)[0])instanceof P?r.proto.list.length?(i.classList.remove("onkeyboardControl"),(r=r.proto.list[0]).classList.add("onkeyboardControl")):(r=i).click():(r=i.querySelector(".keyboardController"))?(i.classList.remove("onkeyboardControl"),r.classList.add("onkeyboardControl")):(r=i).click();break;case RealElement.keyboardController?.back:for(r=i;(r=r.parentElement)&&!r.classList.contains("keyboardController"););(r?(i.classList.remove("onkeyboardControl"),r):r=i).classList.add("onkeyboardControl")}if(t++)if((r=i).classList.remove("onkeyboardControl"),t){for(;(r=r.nextElementSibling)&&"none"===getComputedStyle(r).display;);(r=r||i.parentElement.firstElementChild).classList.add("onkeyboardControl")}else{for(;(r=r.previousElementSibling)&&"none"===getComputedStyle(r).display;);(r=r||i.parentElement.lastElementChild).classList.add("onkeyboardControl")}r&&r.animate({opacity:[1,0,1]},{duration:500})}}}),{previous:"ArrowUp",next:"ArrowDown",enter:"ArrowRight",back:"ArrowLeft"});static makeElementByString=(()=>{let t=o?document.createElement("template"):{content:{}};function makeElementByString(e){return t.innerHTML=String(e),t.content.firstElementChild}return makeElementByString._clear=()=>(t.innerHTML="",t.content),makeElementByString})();static createImg(){return new RealElement({self:document.createElement("img"),key:"src"})}static createVideo(){return new RealElement({self:document.createElement("video"),key:"src"})}static createAudio(){return new RealElement({self:document.createElement("audio"),key:"src"})}static createDiv(e,t=""){return new RealElement({self:document.createElement("div"),key:"textContent"},{id:e,initValue:t})}static createTextarea(e){var t=document.createElement("textarea");return new RealElement({self:(t.placeholder=String(e),t),key:"value"})}static newXHTML=(e,t,r)=>(Object.assign(Object.assign(e=document.createElement(e),t).style,r),e);static newSVG=(e,t,r)=>RealElement.makeElement(document.createElementNS("http://www.w3.org/2000/svg",e),t,r);static newDocumentFragmentFromElements(e){var t,r=new DocumentFragment;for(t of e)try{r.appendChild(t)}catch(e){console.error(e)}return r}static applyKeyboardController(...e){for(var t of e)t instanceof l?t.classList.add("keyboardController"):t?.self instanceof l&&t.self.classList.add("keyboardController")}static cancelKeyboardController(...e){for(var t of e)t instanceof l?t.classList.remove("keyboardController"):t?.self instanceof l&&t.self.classList.remove("keyboardController")}static makeElement(e,t,r){var i,s=(e=e instanceof l?e:document.createElement(e)).style;if(t)for(var o of Object.keys(t))try{if(o in e)try{"object"==typeof(i=e[o])&&null!==i?"baseVal"in i&&e.setAttribute(o,t[o]):e[o]=t[o]}catch(e){console.error(e)}else o in s&&(s[o]=String(t[o]))}catch(e){console.error(e)}return Object.assign(s,r),e}static newElements(e,t,r){var i=t[Symbol.iterator]();if(r)if(r=new DocumentFragment,"svg"===e)for(t of i)r.appendChild(document.createElementNS("http://www.w3.org/2000/svg",t?.tagName??t));else for(t of i)r.appendChild(document.createElement(t?.tagName??t));else if(r=[],"svg"===e)for(t of i)r.push(document.createElementNS("http://www.w3.org/2000/svg",t?.tagName??t));else for(t of i)r.push(document.createElement(t?.tagName??t));return r}static addEventListenerBySelectors=(e,t,r)=>{let i=t.replace(t[0],t[0].toUpperCase());e&&"*"!==e?(RealElement.selectorEventListeners[t]||(RealElement.selectorEventListeners[t]=new Map,addEventListener(t,r=>{var e=s.now();RealElement.selectorEventListeners[t].forEach((e,t)=>function temp(e,t,r){try{if(Array.from(document.querySelectorAll(r)).includes(e.target))for(var i=0,s=t.length;i<s;)try{t[i++](e)}catch(e){console.error,alert(e?.stack??e)}}catch(e){console.error(e)}}(r,e,t)),f(i+"-listeners completed\nin "+w.makeNumStr0oTail(s.now()-e)+" ms.")})),RealElement.selectorEventListeners[t].has(e)?RealElement.selectorEventListeners[t].get(e).push(r):RealElement.selectorEventListeners[t].set(e,[r])):addEventListener(t,r)};static addCSSRules=(()=>{if(!o){let e=()=>e;return e._css=y.onload,e}var r=y.onload.then(function(){var e=document.getElementsByTagName("head")[0].appendChild(document.createElement("style"));window.createPopup||e.appendChild(document.createTextNode("")),r=e.sheet});let n=/^\.([A-Za-z][A-Z0-9a-z]{0,})$/,l=/[A-Za-z]$/,c=/^[A-Za-z]/,h=e=>Object(e)===e?Object.keys(e):[];var i=globalThis.CSSStyleSheet.prototype.insertRule?(e,t)=>r.insertRule(e+"{\n"+t+"}",r.cssRules.length):(e,t)=>r.addRule(e,t,-1),u=(e,t)=>r instanceof Promise?r.then(()=>(u=i)(e,t)):(u=i)(e,t);function addCSSRules(t,r){try{if(Array.isArray(t)){let e=t.length;for(;0<e--;)"string"==typeof t[e]&&addCSSRules(t[e],r);return addCSSRules}"string"!=typeof t&&RealElement.error('"prefix" in addCSSRules must be String !');for(var e of h(r)){var i,s=r[e],o=[];for(i of h(s))o.push(i,":",String(s[i]),";\n");u(t+(l.test(t)&&c.test(e)?" ":"")+e+" ",o.join(""))}var a=n.exec(t)?.[1];a&&RealElement.myStyle.set(a,Object.assign({},RealElement.myStyle.get(a),r))}catch(e){console.error(e)}return addCSSRules}return addCSSRules._css=r,addCSSRules})();static defaultInit=(t=!1,()=>t?y.onload:y.onload=(t=!0,y.onload.then(()=>w.time(()=>{RealElement.addCSSRules("",{"*":{margin:"0",padding:"0",border:"0","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"},":root":{"--mapWidth":"1920px","--halfBlack":"rgba(0, 0, 0, 0.5)","--halfWhite":"rgba(225, 225, 225, 0.5)","--noColor":"rgba(0, 0, 0, 0)"},pre:{"text-align":"left","align-content":"left","vertical-align":"top","white-space":"pre-wrap","word-wrap":"break-word"},html:{cursor:"default","background-color":"black",color:"white"},body:{transform:"rotate(0)","transform-origin":"50vmin 50vmin",overflow:"visible scroll"},"body>*":{position:"absolute"},hr:{border:"1px solid white,"},"::-webkit-scrollbar":{display:"none"}})(".coverBody",{"":{width:"100vmax",height:"56.25vmax"}})(".noDisplay",{"":{display:"none"}})(".disappear",{"":{visibility:"hidden"}})(".listDown",{"":{"writing-mode":"horizontal-tb"},">*":{position:"relative",display:"block"}})(".listRight",{"":{"writing-mode":"vertical-lr"},">*":{position:"relative",display:"block"}})(".listDownListRight",{"":{"writing-mode":"horizontal-tb"},">*":{position:"relative",display:"block","writing-mode":"vertical-lr"},">*>*":{position:"relative",display:"block"}})(".listRightListDown",{"":{"writing-mode":"vertical-lr"},">*":{position:"relative",display:"block","writing-mode":"horizontal-tb"},">*>*":{position:"relative",display:"block"}})("div.listClose",{"":{"writing-mode":"horizontal-tb"},">*":{position:"absolute"},">:nth-child(1)":{"z-index":"1"},">:nth-child(2)":{"z-index":"2"},">:nth-child(3)":{"z-index":"3"},">:nth-child(4)":{"z-index":"4"},">:nth-child(5)":{"z-index":"5"},">:nth-child(6)":{"z-index":"6"},">:nth-child(7)":{"z-index":"7"},">:nth-child(8)":{"z-index":"8"},">:nth-child(9)":{"z-index":"9"},">:nth-child(10)":{"z-index":"10"},">:nth-child(11)":{"z-index":"11"},">:nth-child(12)":{"z-index":"12"},">:nth-child(13)":{"z-index":"13"},">:nth-child(14)":{"z-index":"14"},">:nth-child(15)":{"z-index":"15"}})("div.listFar",{"":{"writing-mode":"horizontal-tb"},">*":{position:"absolute"},">:nth-last-child(1)":{"z-index":"1"},">:nth-last-child(2)":{"z-index":"2"},">:nth-last-child(3)":{"z-index":"3"},">:nth-last-child(4)":{"z-index":"4"},">:nth-last-child(5)":{"z-index":"5"},">:nth-last-child(6)":{"z-index":"6"},">:nth-last-child(7)":{"z-index":"7"},">:nth-last-child(8)":{"z-index":"8"},">:nth-last-child(9)":{"z-index":"9"},">:nth-last-child(10)":{"z-index":"10"},">:nth-last-child(11)":{"z-index":"11"},">:nth-last-child(12)":{"z-index":"12"},">:nth-last-child(13)":{"z-index":"13"},">:nth-last-child(14)":{"z-index":"14"},">:nth-last-child(15)":{"z-index":"15"}})(".onhover",{":hover":{background:"linear-gradient(#fff,#000,#000,#fff)"}})(".onactive",{":active":{background:"linear-gradient(#000,#fff,#fff,#000)"}})(".childOnhover",{">:hover":{background:"linear-gradient(#fff,#000,#000,#fff)"}})(".childOnactive",{">:active":{background:"linear-gradient(#000,#fff,#fff,#000)"}})(".relativeSquare",{"":{width:"20vmin",height:"20vmin"}})(".fontTitle",{"":{"font-size":"20vmin"}})(".fontHead",{"":{"font-size":"10vmin"}})(".fontNormal",{"":{"font-size":"3vmin"}})(".scrollY",{"":{overflow:"hidden scroll"}})(".scrollX",{"":{overflow:"scroll hidden"}})(".scrollXY",{"":{overflow:"scroll"}})(".scrollNone",{"":{overflow:"hidden"}})(".centerCenter",{"":{"text-align":"justify","align-items":"center","align-content":"center","vertical-align":"baseline","justify-content":"center"}})(".autoFull",{"":{width:"100vmax",height:"100vmin"}})(".selfCenterCenter",{"":{left:"50%",top:"50%",transform:"translate(-50%,-50%)"}})._css.finally()},e=>f("Init defaultCSS\nin "+w.makeNumStr0oTail(e)+" ms.")))))};{let t=function(){return null==this||this===globalThis?new t:(this.resolve=null,this.reject=null,this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),this)};var L=new class RealStory{newPage(){return new RealStory(this)}newPrivatePage(t){return new Promise(e=>e(t?.(this.newPage())))}then(e){return"function"==typeof e&&this.fnList.unshift(e),this}getNextPage(){var e;if(this.ofStory instanceof RealStory)return(e=this.ofStory.pages)[e.indexOf(this)+1]}getPreviousPage(){var e;if(this.ofStory instanceof RealStory)return(e=this.ofStory.pages)[e.indexOf(this)-1]}newPromiseObj(){let e=new t;return this.then(()=>e.promise),e}async launch(){for(var t=0,e=this;(e=e.ofStory)instanceof RealStory;)t++;var r=!t;for(r&&(i=!0);this.pages.length||this.fnList.length;){for(;this.fnList.length;)try{this.info=await this.fnList.pop()?.(this.info)}catch(e){console.error("Depth of the fn : "+t+"\n"+String(e?.stack??e))}try{await this.pages.shift()?.launch?.()}catch(e){console.error("Depth of the page : "+t+"\n"+String(e?.stack??e))}}r&&(i=!1)}get StoryPromise(){return t}get index(){return this.ofStory instanceof RealStory?this.ofStory.pages.indexOf(this):-1}ofStory;pages=[];fnList=[];info;constructor(e){(this.ofStory=e instanceof RealStory&&e)&&e.pages.push(this)}};let i=Reflect.getPrototypeOf(L).constructor=!1;y.onload.then(()=>Reflect.getPrototypeOf(L).constructor=m(()=>i||L.launch(),50))}var C,E,x,O,k,P,A,j,T,D,B,I=new class RealPromise{newOne(e){return new RealPromise(e)}catch(e){return this.self=Promise.resolve(this.self).catch(e),this}finally(e){return this.self=Promise.resolve(this.self).finally(e),this}_push(e){return this.list.push(e),e}_throw(e){throw this.list.push(e),e}then(e,t){return this.self=Promise.resolve(this.self).then(e,t).then(this._push,this._throw),this}async tryHandler(e,t){if("function"!=typeof e)throw new TypeError('"handler" must be Function !');try{await this.self}catch(e){console.error(this.length,e)}for(var r=this.length;0<r--;)try{try{return e(await this.list[r])}catch(e){(t??console.error)(e)}}catch(e){console.error(e)}}get require(){return RealPromise.require}static require=(()=>{let i={},s=/[^\/]+\/\.\.\//g;return d?function(e){return this instanceof RealPromise&&this._push(Promise.resolve(r(String(e))))}:o?function(e){var t,r;if(e=String(e).replaceAll("\\","/"),!(this instanceof RealPromise))return Promise.reject();for(;s.test(e);)e=e.replaceAll(s,"");return i[e]||(i[e]=(t=L.StoryPromise(),document.head.appendChild(((r=document.createElement("script")).onload=t.resolve,r.onerror=t.reject,r.src=e,r)),this._push(t.promise.finally(function onfinally(){this.remove()}.bind(r)))))}:function(){return Promise.reject(new Error("Mode error !"))}})();get length(){return this.list.length}list=[];constructor(e){this.self=Promise.resolve(e).then(this._push=e=>(this.list.push(e),e),this._throw=e=>{throw this.list.push(e),e}),Reflect.defineProperty(this,"list",h),Reflect.defineProperty(this,"_push",h),Reflect.defineProperty(this,"_throw",h)}}(y.onload.then(()=>e));return I.self.finally(()=>w.time(y.onload,e=>f("Set up\nin "+w.makeNumStr0oTail(e)+" ms."))),o?(C=class RealCanvas extends N{static proto=class AntiCanvas extends S.proto{temp=document.createElement("canvas").getContext("2d");backup=document.createElement("canvas").getContext("2d");img=new Image;isElement=!0;clearBeforeDraw=!0;ctx};static useCache=!0;static srcImageMap=new Map;static newBySelf(e){return new RealCanvas(e)}static strN(e,t){return String(e).padStart(t,"0")}static preloadSrc(...e){for(var t=n.concat(...e),r=t.length;0<r--;)t[r]=RealCanvas.getImageBySrc(t[r]);return Promise.allSettled(t)}static getImageBySrc=r=>new Promise((e,t)=>function dealWithSrc(e,t,r){let i=RealCanvas.srcImageMap.get(e)??new Image;i.src?t(i):!e||"string"!=typeof e||RealCanvas.useCache&&RealCanvas.srcImageMap.has(e)?r():(i.onload=()=>(RealCanvas.srcImageMap.set(e,i),i.onload=i.onerror=t(i)),i.onerror=r,i.src=e,i)}(r,e,t));static getRealGroupToClear=(()=>{class ConfigToClearShape{x=0;y=0;radiusX;radiusY;shape;relative}return function getRealGroupToClear(e,{initFn:t,fnBeforeClear:r,fnAfterClear:i}=p){if(!(e instanceof RealCanvas))throw new Error('=> "realCanvas" must be instanceof RealCanvas !');"function"==typeof i&&(i=()=>i.call(e)),"function"==typeof r&&(r=()=>r.call(e));let s=new ConfigToClearShape,o=new b({self:s});return o.addSetterListener(null,async()=>{await Promise.resolve(e.loaded).then(r),await e.clearShape(s,s.shape).then(i)}),e.loaded.finally(t),o}})();protoTransform(){}protoGet(){return this.loaded.then(()=>this.proto.value)}clearAsync(){return this.loaded=Promise.resolve(this.loaded).then(()=>this.clear())}fix(e=this.proto.temp.canvas){(this.proto.clearBeforeDraw?this.clear():this.proto.ctx).drawImage(e,0,0)}preloadSrc(...e){return this.loaded=Promise.resolve(this.loaded).then(()=>RealCanvas.preloadSrc(...e))}clear(){return this.proto.ctx.clearRect(0,0,this.proto.self.width,this.proto.self.height),this.proto.ctx.closePath(),this.proto.ctx}clearTemp(){return this.proto.temp.clearRect(0,0,this.proto.self.width,this.proto.self.height),this.proto.temp.closePath(),this.proto.temp}testSrc(t){return this.loaded=Promise.resolve(this.loaded).then(()=>RealCanvas.getImageBySrc(t)).then(()=>!0,e=>this.rejectSrc(t,e))}rejectSrc(e,t){return e&&console.error(t instanceof Error?t:(RealCanvas.useCache&&t&&RealCanvas.srcImageMap.set(e),this+': Fail to load by src "'+e+'" !')),!1}protoSet(t){return this.loaded=Promise.resolve(this.loaded).then(()=>RealCanvas.getImageBySrc(t)).then(e=>(this.proto.img=e,this.proto.value=t,!0),e=>this.rejectSrc(t,e))}toBlob(){try{return y.cb2promise({thisArg:this.self,useFn:"toBlob"}).then(e=>e[0]instanceof Error?(console.error(e[0]),new Blob):e[0])}catch(e){return console.error(e),Promise.resolve(new Blob)}}resizeBySrc(e){return this.loaded=Promise.resolve(this.loaded).then(()=>RealCanvas.getImageBySrc(e)).then(e=>{this.self.width!==e.naturalWidth&&(this.width=e.naturalWidth),this.self.height!==e.naturalHeight&&(this.height=e.naturalHeight)})}realSet(e,t,r,i){var s;return this.loaded=Array.isArray(e)?this.multiDrawSrcArray({},...e).then(()=>{this.proto.value=e}):Promise.resolve(this.proto.set.call(this,this.proto.tryRealNode&&(s=this._computePositionsOfRNs(e)).length?this._dealWithPositionsOfRNs(s,e):e)??!0).then(e=>e&&(this.fix(this.img),t&&this.react?.(),r&&this.notify(i),!0)).catch(e=>(console.error(e),e))}multiDrawSrcArray({bgSrc:e,autoOpacity:t,resize:r},...i){this.preloadSrc(e,i);var s=-1,o=e??i[0]??!1;if(r&&o&&this.resizeBySrc(o),this.loaded=Promise.resolve(this.loaded).then(()=>this.clearTemp()),Array.isArray(e))for(o=e.length;o>++s;)this.temp=e[s];else e&&"string"==typeof e&&(this.temp=e);if(1<i.length&&t)for(s=i.length,o=0;0<s--;)this.tempOpacity=.625**s,this.temp=i[o++];else for(s=-1,o=i.length;o>++s;)this.temp=i[s];return this.loaded=Promise.resolve(this.loaded).then(()=>{this.fix(this.proto.temp.canvas)},e=>f(e?.stack??e))}applyMouseClear({radiusX:t,radiusY:r,relative:i}=p,s){let o=this.proto.self,e=this.proto.backup,a=getComputedStyle(o),n=()=>(e.canvas.width=o.width,e.canvas.height=o.height,e.drawImage(o,0,0)),l=e=>(c(),this.clearShape({x:e.offsetX*o.width/+a.width.slice(0,-2),y:e.offsetY*o.height/+a.height.slice(0,-2),radiusX:t,radiusY:r,relative:i},s)),c=()=>this.clear().drawImage(e.canvas,0,0);return o.addEventListener("mouseenter",n),o.addEventListener("mouseleave",c),o.addEventListener("mousemove",l),()=>(o.removeEventListener("mouseenter",n),o.removeEventListener("mouseleave",c),o.removeEventListener("mousemove",l))}clearShape({x:a=0,y:n=0,radiusX:l,radiusY:c,relative:h}=p,u){var e=!1;return"number"==typeof l?"number"!=typeof c&&(c=l):"number"==typeof c?l=c:e=!0,(e=e||!Number.isFinite(l+c))?Promise.reject(new Error('"radiusX": '+String(l)+' or "radiusY": '+String(c)+" must be legal number !")):("number"!=typeof a&&(a=0),"number"!=typeof n&&(n=0),(e=e||!Number.isFinite(a+n))?Promise.reject(new Error('"x": '+String(a)+' or "y": '+String(n)+" must be legal number !")):this.loaded=Promise.resolve(this.loaded).then(()=>{var e,t=this.proto.self,r=this.proto.temp,i=0;if(l=Math.abs(h?l*this.width/2:l),c=Math.abs(h?c*this.height/2:c),r.canvas.width=t.width,r.canvas.height=t.height,r.drawImage(t,0,0),"rect"!==u){a=Math.round(a),n=Math.round(n),l=Math.ceil(l);for(var s=(c=Math.ceil(c))**2,o=s/l**2;i++<l;)e=Math.floor(Math.sqrt(s-i**2*o))+1,r.clearRect(a-i,n-e,2*i,2*e)}else r.clearRect(Math.floor(a-l),Math.floor(n-c),Math.ceil(2*l),Math.ceil(2*c)),this.clear().drawImage(r.canvas,0,0);this.clear().drawImage(r.canvas,0,0)}).catch(e=>console.error(e)))}animate({prefix:r,suffix:i,startN:s=0,length:o,midLength:a,bgSrc:n,playMode:l=0,timeSep:c=100,sizeMode:h="std",resizeAfter:u=!0}=p){let f={width:this.width,height:this.height},e=[];var d=s+o+l;for(o*="1235"[l]||1,c/="1235"[l]||1;d-- >s;)e.push(r+RealCanvas.strN(d,a)+i);return this.preloadSrc(e),d=0,{loaded:this.loaded,finished:this.loaded.then(()=>{var e;let t=new y(c);switch("auto"===h&&(e=!0),l){default:for(;0<o--;)t.then(this.multiDrawSrcArray,this,{bgSrc:n,resize:e},r+RealCanvas.strN(s++,a)+i);case 1:for(;0<o--;)t.then(this.multiDrawSrcArray,this,{bgSrc:n,autoOpacity:!0,resize:e},(d=!d)||r+RealCanvas.strN(s++,a)+i,!1,r+RealCanvas.strN(s,a)+i);break;case 2:for(;0<o--;)t.then(this.multiDrawSrcArray,this,{bgSrc:n,autoOpacity:!0,resize:e},1===d?r+RealCanvas.strN(s+1,a)+i:2===d&&r+RealCanvas.strN(s,a)+i,!1,d<2?r+RealCanvas.strN(s,a)+i:r+RealCanvas.strN(s+1,a)+i),3==++d&&(s++,d%=3);break;case 3:for(;0<o--;)t.then(this.multiDrawSrcArray,this,{bgSrc:n,autoOpacity:!0,resize:e},1===d?r+RealCanvas.strN(s+1,a)+i:4===d&&r+RealCanvas.strN(s,a)+i,!1,2===d?r+RealCanvas.strN(s+1,a)+i:3===d&&r+RealCanvas.strN(s,a)+i,!1,d<3?r+RealCanvas.strN(s,a)+i:2<d&&r+RealCanvas.strN(s+1,a)+i),5==++d&&(s++,d%=5)}return t.then(()=>(this.clearTemp(),u&&(this.width=f.width,this.height=f.height),t.destroy()))})}}get ctx(){return this.proto.ctx}get img(){return this.proto.img}get imgW(){return this.proto.img.naturalWidth}get imgH(){return this.proto.img.naturalHeight}get width(){return this.proto.self.width}set width(e){null!=e&&(this.proto.self.width=this.proto.temp.canvas.width=e)}get height(){return this.proto.self.height}set height(e){null!=e&&(this.proto.self.height=this.proto.temp.canvas.height=e)}get self(){return this.proto.self}set self(e){e instanceof HTMLCanvasElement&&(this.proto.ctx=(this.proto.self=e).getContext("2d"))}get clearBeforeDraw(){return this.loaded.then(()=>this.proto.clearBeforeDraw)}set clearBeforeDraw(e){this.loaded=Promise.resolve(this.loaded).then(()=>this.proto.clearBeforeDraw=e)}get temp(){return this.proto.temp.canvas}set temp(t){return this.proto.set.call(this,t).then(()=>(this.proto.temp.drawImage(this.img,0,0),!0),e=>this.rejectSrc(t,e))}get opacity(){return this.loaded.then(()=>this.proto.ctx.globalAlpha)}set opacity(t){Array.isArray(t)||(t=[t]),this.loaded=Promise.resolve(this.loaded).then(()=>t[0]).then(e=>{this.proto.ctx.globalAlpha=e*(t[1]??1)})}set tempOpacity(t){Array.isArray(t)||(t=[t]),this.loaded=Promise.resolve(this.loaded).then(()=>t[0]).then(e=>{this.proto.temp.globalAlpha=e*(t[1]??1)})}loaded=w.now;constructor(e,t,r,i,...s){var o=e,a=o instanceof l?(e=o.id,o):"string"==typeof o?document.getElementById(o):(e="",!1);!a||a instanceof HTMLCanvasElement||w.error('=> "id" exists but not within an HTMLCanvasElement !'),N.addId(e,!a),o={id:e},super({self:a||N.newXHTML("canvas",o)},o,i,...s),this.proto,this.width=t,this.height=r,this.proto.ctx=this.proto.self.getContext("2d")}},E=class RealLoader extends N{static proto=class AntiLoader extends S.proto{onerror;onloadend};static fs=(()=>{let t={method:"HEAD"},r=e=>[,e],i=e=>[e];class DocumentFs{get stat(){return DocumentFs.stat}get readdir(){return DocumentFs.readdir}}return DocumentFs.fetch=(()=>{let r=e=>e.status<300?e:RealLoader.error("Failed request !");return o&&"file:"===document.location.protocol?(e,t)=>fetch(e,((t=Object.assign({},t)).mode="no-cors",t)).then(r):(e,t)=>fetch(e,Object(t)).then(r)})(),DocumentFs.stat=d?async e=>y.cb2promise({thisArg:await v,useFn:"stat"},e):e=>DocumentFs.fetch(e,t).then(r,i),DocumentFs.readdir=d?async e=>y.cb2promise({thisArg:await v,useFn:"readdir"},e):async(e,...t)=>{try{var r,i=t.length,s=i;for(/\/$/.test(e)||(e+="/");0<s--;)if(Array.isArray(t[s]))for(r=t[s].length;0<r--;)t[s][r]=String(t[s][r]);else{var o=String(t[s]);if("\\"===o[0])switch(o[1]){case"w":t[s]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";break;case"d":t[s]="0123456789"}else t[s]=[o]}for(var a=[],n=[],l=[],c=Array(i).fill(0);!("-1"in c);){for(r="",s=0;s<i;s++)r+=t[s][c[s]];for(n.push(r),r=e+r,a.push(DocumentFs.stat(r)),c[(s=i)-1]++;0<s--;)t[s].length>c[s]||(c[s]=0,c[s-1]++)}for(var h=await Promise.all(a),u=h.length,s=0;s<u;s++)h[s][0]??f(l.push(n[s]),n[s]);return[null,l]}catch(e){return[e,[]]}},new DocumentFs})();static _configDescriptor=(o&&addEventListener("click",async e=>{if(e.target.classList.contains("RealLoader"))for(var t of S.searchByObj(e.target))if(t instanceof RealLoader){try{var r=(await RealLoader.load(t))[0];r?t.onerror?.(r):t.onloadend?.()}catch(e){console.error(e)}t.notify(!0),t.react?.();break}}),{writable:!1,enumerable:!1,configurable:!1});static newByType(e){return new RealLoader(e,"file")}static getArrayBufferFrom(e){return Promise.resolve(e instanceof ArrayBuffer?e:ArrayBuffer.isView(e)?e.buffer:(e instanceof Blob?e:new Blob(Array.isArray(e)?e.join(""):String(e))).arrayBuffer())}static load=d?async t=>{try{if("upload"===t.type){let e=t.temp.files;return t.temp.click(),await y.onceIf(()=>e!==t.temp.files,10),[]}let r=await v;var e=await t.dataGetter(),{1:i="file",2:s=""}=/(.+)(\..+)/.exec(t.temp.download)||n,o=await y.cb2promise({thisArg:r,useFn:"stat"},"./"+t.temp.download);if(o||this.error("Unknown Error !"),o[0])return RealLoader.getArrayBufferFrom(e).then(e=>y.cb2promise({thisArg:r,useFn:"writeFile"},"./"+t.temp.download,Buffer.from(e)));for(var a=1;;a++){1;{let t="./"+i+" - "+a+s;if((await y.cb2promise({thisArg:r,useFn:"stat"},t))[0])return RealLoader.getArrayBufferFrom(e).then(e=>y.cb2promise({thisArg:r,useFn:"writeFile"},t,Buffer.from(e)))}}}catch(e){return[e]}}:(()=>{let i=e=>new Blob(e);return async t=>{try{if("upload"===t.type){let e=t.temp.files;t.temp.click(),await y.onceIf(()=>e!==t.temp.files,10)}else{var e=await t.dataGetter(),r=URL.createObjectURL(await("string"==typeof e?new Blob([e]):e instanceof Blob?e:RealLoader.getArrayBufferFrom(e).then(i)));t.temp.href=r,t.temp.click(),URL.revokeObjectURL(r)}return[]}catch(e){return[e]}}})();load(){return RealLoader.load(this)}protoSet(e){return this.self[this.key]=String(e),!1}get files(){return"upload"===this.type?this.temp.files:this.error("I'm an downloader without files !")}get onerror(){return this.proto.onerror}set onerror(e){this.proto.onerror="function"==typeof e?e:null}get onloadend(){return this.proto.onloadend}set onloadend(e){this.proto.onloadend="function"==typeof e?e:null}get fileName(){return"upload"===this.type?this.error('Uploader bans "fileName" !'):this.temp.download}set fileName(e){"upload"===this.type&&this.error('Uploader bans "fileName" !'),"symbol"==typeof e&&this.error('"fileName" must be String but not Symbol !'),d&&!/^\.\//.test(e)&&(e="./"+e),this.temp.download=e}dataGetter;constructor(e,t,r,{innerHTML:i,onerror:s,onloadend:o}=p){super({self:document.createElement("div"),key:"innerHTML"}),this.proto,this.onerror=s,this.onloadend=o,this.dataGetter=r,this.value=i,e=Boolean(e),this.temp=document.createElement(e?"a":"input"),Reflect.defineProperty(this,"temp",RealLoader._configDescriptor),this.type=e?(this.fileName=t||"file","download"):(this.temp.type="file","upload"),Reflect.defineProperty(this,"type",RealLoader._configDescriptor)}},x=class RealSelect extends N{static proto=class AntiSelect extends S.proto{list=[]};static newBySelf(e){return new RealSelect(e)}static _react(e,t=!0,r=!0,i=!0){try{for(var s,o,a=this._getPositionsOfChildRN(e);a.length;){var n=a.pop().reverse(),l=e.value;if(!n.length)return this.realSet(l,t,r,i);for(s=this.proto.value;1<n.length;)s=s[n.pop()];if(l!==s[n[0]]&&(s[n[0]]=l),s===this.proto.value){o=0;for(var c of Object.keys(s)){if(c===n[0]){this.proto.list[o].value=String(l);break}o++}}}return t&&this.react?.(i),r&&this.notify(i),!0}catch(e){if(this instanceof RealSelect)throw e;this.error('Please avoid using method "react" of typeof '+this?.name+" !\n"+e.message)}}protoSet(e){return this.proto.value=Object.assign({},e),!0}fix(){return this.self[this.key]=this.protoTransform(this.proto.value),this.proto.list=Array.from(this.self.children),this}getValueIndexs(){for(var e=this.proto.list.length,t=[];0<e--;)this.proto.list[e].selected&&t.push(e);return t.reverse()}protoGet(){for(var e=[],t=this.proto.list,r=t.length,i=0;i<r;i++)t[i].selected&&e.push(t[i].value);return e}protoTransform(e,t=String(this.defaultKey),r=String(this.defaultValue)){this instanceof RealSelect&&!this.self.multiple&&(e=Object.assign({[t]:r},e));for(var i,s=[],o=Object.entries(e).sort((e,t)=>e[0].localeCompare(t[0])).sort((e,t)=>e[0]-t[0]).values();!(i=o.next()).done;)s.push(`<option value="${String(i.value[1])}" ${i.value[0]===t?"selected":""}>${i.value[0]}</option>`);return s.join("")}get list(){return this.proto.list}constructor(e,t,r,i,s,o,a){var n=e,n=n instanceof l?(e=n.id,n):"string"==typeof n?document.getElementById(n):(e="",!1);n&&(n instanceof HTMLSelectElement?(n.multiple=t,n.onchange=a):w.error('=> "id" exists but not within an HTMLSelectElement !')),N.addId(e,!n),super({key:"innerHTML",self:n||N.newXHTML("select",{id:e,multiple:t,onchange:a})},{id:e,initValue:Object.assign({},r)},i),this.proto,this.defaultKey=s??"_",this.defaultValue=o??"",this.fix()}},O=class RealComtag extends N{static comtagClassMap=new Map;static newBySelf(e){return new RealComtag(e)}static defineComtagClass(e,t){var{optionList:t=[],tryRealNode:r,selfAssign:i,cssRuleObjObj:s,callback:o}=t||p;/^([A-Za-z]\w*)$/.test(e)||this.error('Illegal "className" !'),this.comtagClassMap.has(e)&&this.error('"className" repeated !'),t?.[Symbol.iterator]||this.error('"optionList" must be Array !'),this.addCSSRules("."+e,s),this.comtagClassMap.set(e,[t,r,i,"function"==typeof o?o:null])}static createByClassName(e,...t){Comtag;var r=this.comtagClassMap.get(e),i=(r||this.error('"className" not found !'),new RealComtag("",r[0],r[1],r[2]));return r[3]&&r[3].apply(i,t),i.addClassName(e),i}protoTransform(e){return N.newElements("",e,!0)}fix(){return this.self.innerHTML="",this.self.appendChild(this.transform(this.proto.value)),this}protoSet(e){if(!e?.[Symbol.iterator])throw new Error('=> "value" must be Array !');for(var t=Array(2),r=u(e,"tagName"),i=u(this.proto.value,"tagName");t[0]=i.next(),t[1]=r.next(),!t[0].done^t[1].done&&!t[0].done;)if(t[0].value.toLowerCase()!==t[1].value.toLowerCase())return this.proto.value=Array.from(e),!0;return!1}constructor(e,t,r,i){var s=e,s=s instanceof l?(e=s.id,s):"string"==typeof s?document.getElementById(s):(e="",!1);N.addId(e,!s),super({self:s||N.newXHTML("div",i)},{id:e,initValue:t?.[Symbol.iterator]?Array.from(t):[]},r),this.fix().proto.self.id=e}},k=class RealSVG extends O{static newByTagName(e){return new RealSVG(e)}static newImages(e,t){var r=e[Symbol.iterator]();if(t)for(e of(t=new DocumentFragment,r))try{t.appendChild(document.createElementNS("http://www.w3.org/2000/svg","image")).href.baseVal=String(e)}catch(e){console.error(e)}else for(e of(t=[],r))try{var i=document.createElementNS("http://www.w3.org/2000/svg","image");t.push(i),i.href.baseVal=String(e)}catch(e){console.error(e)}return t}protoTransform(e){return N.newElements("svg",e,!0)}constructor(e,t,r,i){super(N.newSVG(e,r),t,!1),"function"==typeof i&&i.call(this,Array.from(this.proto.self.children))}},P=class RealDivList extends N{static proto=class AntiList extends S.proto{list=[];childrenList=[]};static divListClassMap=new Map;static newBySelf(e){return new this(e)}static createList(e=0,t,r,i){for(var s=[];0<e--;)s.push(document.createElement(t));return new RealDivList(r,!0,s,RealDivList.tryRealNode,i)}static _react(e,t=!0,r=!0,i=!0){try{for(var s,o=this._getPositionsOfChildRN(e);o.length;){var a=o.pop().reverse().concat(),n=e.value;if(!a.length)return this.realSet(n,t,r,i);for(s=this.proto.value;1<a.length;)s=s[a.pop()];n!==s[a[0]]&&(s[a[0]]=n),s===this.proto.value&&((a[1]=this.proto.list[a[0]]).innerHTML=""),n instanceof l?a[1].appendChild(n):this.tryHTML?a[1].innerHTML=n:a[1].textContent=n}return t&&this.react?.(i),r&&this.notify(i),!0}catch(e){if(this instanceof RealDivList)throw e;this.error('Please avoid using method "react" of typeof '+this?.name+" !\n"+e.message)}}static defineDivListClass(e,t){var{tryHTML:t,optionList:r=[],tryRealNode:i,selfAssign:s,cssRuleObjObj:o,callback:a}=t||p;/^([A-Za-z]\w*)$/.test(e)||this.error('Illegal "className" !'),this.divListClassMap.has(e)&&this.error('"className" repeated !'),r?.[Symbol.iterator]||this.error('"optionList" must be Array !'),this.addCSSRules("."+e,o),this.divListClassMap.set(e,[t,r,i,s,"function"==typeof a?a:null])}static createByClassName(e,...t){var r=this.divListClassMap.get(e),i=(r||this.error('"className" not found !'),new RealDivList("",r[0],r[1],r[2],r[3]));return r[4]&&r[4].apply(i,t),i.addClassName(e),i}protoGet(){return this.proto.list}protoSet(e){return this.proto.value=Array.from(e),!0}protoTransform(e){var t,r,i=[];try{var s=e[Symbol.iterator]()}catch{throw new Error('=> "value" must be Array !')}for(;!(t=s.next()).done;)i.push(r=document.createElement("div")),t.value instanceof l?r.appendChild(t.value):this.tryHTML?r.innerHTML=String(t.value):r.textContent=String(t.value);return i}getIdDict(e,t){var r,i=Object.create(null),s=this.proto.list.length;if(e)for(;0<s--;)1<(r=this.proto.childrenList[s]).length||!r[0]?.id||(i[r[0].id]=new N({self:this.proto.list[s],key:t}));else for(;0<s--;)1<(r=this.proto.childrenList[s]).length||!r[0]?.id||(i[r[0].id]=this.proto.list[s]);return i}getRealEmentList(){for(var e=this.proto.list.concat(),t=e.length;0<t--;)e[t]=new N({self:e[t]});return e}fix(){for(var e=0,t=this.proto.list=this.transform(this.proto.value),r=this.proto.childrenList=[],i=N.makeElementByString._clear();e<t.length;)r.push(Array.from(i.appendChild(t[e++]).children));return this.self.innerHTML="",this.self.appendChild(i),this}get childrenList(){return this.proto.childrenList}constructor(e,t,r,i,s){var o=e,o=o instanceof l?(e=o.id,o):"string"==typeof o?document.getElementById(o):(e="",!1);N.addId(e,!o),super({self:o||N.newXHTML("div",s)},{id:e,initValue:r?.[Symbol.iterator]?Array.from(r):[]},i),this.proto,this.tryHTML=t,this.fix().proto.self.id=e}},A=class RealImgList extends P{static _react(e,t=!0,r=!0,i=!0){try{for(var s,o=this._getPositionsOfChildRN(e);o.length;){var a=o.pop().reverse(),n=e.value;if(!a.length)return this.realSet(n,t,r,i);for(s=this.proto.value;1<a.length;)s=s[a.pop()];n!==s[a[0]]&&(s[a[0]]=n),s===this.proto.value&&(this.proto.childrenList[a[0]][0].src=String(n?.src??n))}return t&&this.react?.(i),r&&this.notify(i),!0}catch(e){if(this instanceof RealImgList)throw e;this.error('Please avoid using method "react" of typeof '+this?.name+" !\n"+e.message)}}cloneImgList(){for(var e=this.childrenList.concat(),t=e.length;0<t--;)e[t]=e[t][0].cloneNode();return e}protoTransform(e){var t,r,i=[];try{var s=e[Symbol.iterator]()}catch{throw new Error('=> "value" must be Array !')}for(;!(t=s.next()).done;)i.push(t.done=document.createElement("div")),t.done.appendChild(t.value instanceof Image?t.value:((r=new Image).src=String(t.value),r));return i}protoSet(e){if(!e?.[Symbol.iterator])throw new Error('=> "value" must be Array !');for(var t=Array(2),r=u(e,"src"),i=u(this.proto.value,"src");t[0]=i.next(),t[1]=r.next(),!t[0].done^t[1].done&&!t[0].done;)if(t[0].value!==t[1].value)return this.proto.value=Array.from(e),!0;return!1}constructor(e,t,r,i){super(e,!0,t,r,i)}},j=class RealDivQueue extends P{static proto=class AntiQueue extends P.proto{queueArray};static tempTarget=void(o&&(y.onload.then(()=>N.addCSSRules(".RealDivQueue",{">div:hover":{transform:"scale(1.1,1)"},">div:active":{transform:"scale(1.2,1)"}})),addEventListener("mousedown",e=>RealDivQueue.tempTarget=e.target),addEventListener("mouseup",e=>{for(var t,r,i=[r=RealDivQueue.tempTarget];r=r.parentElement;)i.push(r);for(var s=[r=e.target];r=r.parentElement;)s.push(r);if(i.pop()===s.pop()){for(r=[];(r[0]=i.pop())===(r[1]=s.pop());)if(!i.length)return;var[e,o]=r;if(e&&o){var a=e.parentElement;if(a.classList.contains("RealDivQueue")){for(t of S.searchByObj(a))if(t instanceof RealDivQueue)break;a=t.queueArray,a=(r[0]=a.indexOf(t.proto.list.indexOf(r[0])))>(r[1]=a.indexOf(t.proto.list.indexOf(r[1])))?a.slice(0,r[1]).concat(a[r[0]],a.slice(r[1],r[0]),a.slice(r[0]+1)):a.slice(0,r[0]).concat(a.slice(r[0]+1,r[1]+1),a[r[0]],a.slice(r[1]+1)),t.applyQueue(a,e,o)}}}})));getListQueue(){this.proto;for(var e=this.queueArray,t=e.length;0<t--;)e[t]=this.proto.list[e[t]];return e}fix(){for(var e=0,t=this.proto.list=this.transform(this.proto.value),r=this.proto.childrenList=[];e<t.length;)r.push(Array.from(t[e++].children));return this.applyQueue([])}applyQueue(e,t,r){for(var i=this.queueArray??[],s=Array.isArray(e),o=(e=s?e.slice(0,this.proto.list.length):i,this.proto.list.concat()),a=o.length,n=this.self.scrollTop,l=this.self.scrollLeft,c=a;0<c--;)null==e[c]&&(e[c]=c),-1===e.indexOf(c)&&this.error('Illegal "queueArray" !');if(-1!==(c=[i.indexOf(this.proto.list.indexOf(t)),i.indexOf(this.proto.list.indexOf(r))])[0]&&-1!==c[1])c[0]<c[1]?r.insertAdjacentElement("afterend",t):r.insertAdjacentElement("beforebegin",t);else{for(var c=0,h=N.makeElementByString._clear();c<a;)h.appendChild(o[e[c++]]);this.self.classList.add("disappear"),this.self.innerHTML="",this.self.appendChild(h),this.self.scrollTo({top:n,left:l,behavior:"instant"}),this.self.classList.remove("disappear")}return this.proto.queueArray=e,s&&(this.react?.(),this.notify(!0)),this}get queueArray(){return this.proto.queueArray?.concat?.()}},T=(e,t,r)=>P.createByClassName("realDivSelect",e,t,r),y.onload=y.onload.finally(()=>P.defineDivListClass("realDivSelect",{tryRealNode:!0,cssRuleObjObj:{"":{background:"linear-gradient(135deg,#fff,#000)"},">div":{"background-color":"#333",transform:"scale(0.8,1)"},">div:hover":{transform:"scale(0.9,1)"},">.selected":{"background-color":"#555",transform:"scale(1)","font-weight":"bolder"}},callback:(()=>{let t={bubbles:!0,cancelable:!1};function tempGet(){for(var e=[],t=this.proto.list,r=0;t[r];r++)t[r].classList.contains("selected")&&e.push(this.info.optionList[r]);return this.info.multiple||e.length||!r||(t[0].classList.add("selected"),e.push(this.info.optionList[0])),e}function tempSet(e){for(var t of(this.info.optionList=[],this.proto.value=Object.keys(e=Object(e)).sort().sort((e,t)=>e-t)))this.info.optionList.push(e[t]);return this.fix().value,!1}async function tempReact(e){return e.react?.(),await e.notify(),e.self.dispatchEvent(new Event("change",t))}return addEventListener("click",e=>{var t=e.target.parentElement;if(t&&t.classList.contains("realDivSelect")){var r,i=0;for(o=S.searchByObj(t);(r=o.pop())&&!(r instanceof P););if(r){var t=r,s=t.value[0],o=t.proto.list;if(t.info.multiple)return e.target.classList.toggle("selected"),tempReact(t);for(;r=o[i++];)e.target===r?r.classList.add("selected"):r.classList.remove("selected");s!==t.value[0]&&tempReact(t)}}}),function(e,t,r){this.get=tempGet,this.set=tempSet,this.info=Object(this.info),this.info.multiple=Boolean(t),"function"==typeof r&&(this.self.onchange=e=>r.call(this,e)),this.value=e}})()})),D=e=>P.createByClassName("realDivSearch",e),y.onload=y.onload.finally(()=>P.defineDivListClass("realDivSearch",{callback:(()=>{var i;let t={bubbles:!0,cancelable:!1},r=Promise.resolve();function tempGet(){return this.info.inputer.value}function tempSet(e){return Array.isArray(e)?this.info.wordList=e:this.error('"value must be Array !'),r.then(()=>this.info.inputer.dispatchEvent(new Event("input",t))),!((i=i||this).info.matcher.value={})}return addEventListener("click",e=>w.afterNow(()=>function tempReact(e){i&&e!==i.info.inputer&&(i.info.matcher.value={},i.react?.(),i.notify(!0))}(e.target))),N.addEventListenerBySelectors(".RealDivList.realDivSearch>:nth-child(1)>textarea","click",async e=>(await 0,e.target.dispatchEvent(new Event("input",t)))),N.addEventListenerBySelectors(".RealDivList.realDivSearch>:nth-child(1)>textarea","input",e=>{for(var r,t=S.searchByObj(e.target.parentElement.parentElement);(r=t.pop())&&!(r instanceof P););if(r){let t=new RegExp(r.info.inputer.value,"i");r.info.matcher.value=w.arrayToObject(r.info.wordList.filter(e=>t.test(String(e))))}}),N.addEventListenerBySelectors(".RealDivList.realDivSearch>:nth-child(2)>div>div","click",e=>{for(var t,r=S.searchByObj(e.target.parentElement.parentElement.parentElement);(t=r.pop())&&!(t instanceof P););t&&(t.info.inputer.value=t.info.matcher.value[0],(i=t).react?.(),i.notify(!0))}),function(e){var t=P.createByClassName("realDivSelect");this.proto.value=['<textarea placeholder="'+String(e)+'"></textarea>',t.self],this.fix().info=Object(this.info),this.info.inputer=this.proto.childrenList[0][0],this.info.matcher=t,this.info.wordList=[],this.get=tempGet,this.set=tempSet}})(),tryHTML:!0,tryRealNode:!0,cssRuleObjObj:{">:nth-child(2)>div>div:hover":{transform:"scale(0.9,1)"}}})),B=e=>P.createByClassName("realDivSeries",e),y.onload=y.onload.finally(()=>{return P.defineDivListClass("realDivSeries",{tryRealNode:!0,cssRuleObjObj:{">div:nth-child(1)":{"font-weight":"bolder"},".hidden>div:nth-child(n + 2)":{display:"none"}},callback:(N.addEventListenerBySelectors(".RealDivList.realDivSeries>div:nth-child(1)","click",e=>{for(var t,r=N.searchByObj(e.target.parentElement);(t=r.pop())&&!(t instanceof P););t&&t.toggleClassName("hidden")}),function(e){this.transform=getTransform.call(this,e),this.fix()})});function getTransform(t){return"function"==typeof t?e=>function _fn(e,t){return this.protoTransform(n.concat(e(),t))}.call(this,t,e):t instanceof w?e=>function _realNode(e,t){return this.protoTransform(n.concat(String(e.value),t))}.call(this,t,e):e=>function _str(e,t){return this.protoTransform(n.concat(String(e),t))}.call(this,t,e)}})):f("No DOM !"),e.RealWorld=y,e.RealNode=w,e.RealGroup=b,e.RealTarget=S,e.RealStory=L,e.RealPromise=I,e.RealElement=N,e.RealCanvas=C,e.RealLoader=E,e.RealSelect=x,e.RealComtag=O,e.RealSVG=k,e.RealDivList=P,e.RealImgList=A,e.RealDivQueue=j,e.createRealDivSelect=T,e.createRealDivSearch=D,e.createRealDivSeries=B,function tempFn(e){for(var t of Object.keys(e))"function"==typeof e[t]&&(Reflect.defineProperty(e,t,a),tempFn(e[t]))}(e),f("Sync\nin "+w.makeNumStr0oTail(s.now()-M)+" ms."),e})();var RealNode,RealGroup,RealTarget,RealStory,RealPromise,RealElement,RealCanvas,RealLoader,RealSelect,RealComtag,RealSVG,RealDivList,RealImgList,RealDivQueue,createRealDivSelect,createRealDivSearch,createRealDivSeries,RealWorld;
//# sourceMappingURL=./real-node-esm.min.js.map
